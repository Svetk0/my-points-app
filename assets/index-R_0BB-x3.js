(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function c(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=c(n);fetch(n.href,o)}})();const x=document.querySelector(".submitBtn"),M="171c28a2dc0957941680747b5a775d1b",I="https://api.openweathermap.org/data/2.5/weather?units=metric&q=",L="https://api.opentripmap.com/0.1/en/places/",$="5ae2e3f221c38a28845f05b67a4efd428d2e3973acfdb186db7def8c",D="https://restcountries.com/v3.1/alpha/",U=document.querySelector(".currentDate"),d=document.querySelector(".card-name"),f=document.querySelector(".card-currency"),m=document.querySelector(".card-country"),p=document.querySelector(".card-location-link");document.querySelector(".card-location");const u=document.querySelector(".card-main-error"),h=document.querySelector(".card-timezone"),C=document.querySelector(".card-localtime"),g=document.querySelector(".card-info"),b=document.querySelector(".temperature"),S=document.querySelector(".temperature-feels_like"),T=document.querySelector(".humidity"),q=document.querySelector(".wind"),l=g;async function v(e){try{const t=D+e,r=await(await fetch(t)).json();return console.log("search input Code Country:  "+e),r}catch(t){throw console.error("in fetch Country:",t.message),t}}async function A(){try{const e=document.querySelector("#input").value,t=I+e+`&appid=${M}`,r=await(await fetch(t)).json();return console.log("search input Weather:  "+e),r}catch(e){throw console.error("Ошибка запроса in fetch Weather:",e),e}}async function j(){try{const e=document.querySelector("#input").value,t=await y("geoname",`name=${e}`);console.log("search input Info:  "+e);const c=t.lon,r=t.lat,n=await y("radius",`radius=1000&lon=${c}&lat=${r}&format=json&limit=5`);if(console.log("Достопримечательности:",n),Array.isArray(n)&&n.length>0){const o=n.map(i=>i.name).join(", ");l.textContent=`Attractions: ${o}`}else l.textContent="Данные о достопримечательностях отсутствуют в ответе API";return t}catch(e){throw console.error("Ошибка запроса in fetch Info:",e),e}}function y(e,t){return new Promise(function(c,r){let n=L+e+"?apikey="+$;t!==void 0&&(n+=`&${t}`),fetch(n).then(o=>o.json()).then(o=>{c(o)}).catch(function(o){r(o),console.error("Ошибка запроса:",o),l.textContent="Произошла ошибка при запросе к API"})})}function O(){document.querySelector(".card_main").style.display="flex",u.style.display="none",f.textContent="",m.textContent="",p.href="",d.textContent="",g.textContent="",h.textContent="",C.textContent="",b.textContent="",S.textContent="",T.textContent="",q.textContent="",document.querySelector(".card-location").style.display="none"}function H(e){let t=e[0].currencies[Object.keys(e[0].currencies)[0]].name+" ("+e[0].currencies[Object.keys(e[0].currencies)[0]].symbol+")";f.textContent="Currency: "+t,document.querySelector(".card-location").style.display="block",p.href=e[0].maps.googleMaps,m.textContent="Country: "+e[0].name.common}function W(e){b.innerHTML="Temperature: "+Math.round(e.main.temp)+"&#8451",S.innerHTML="Feels like: "+Math.round(e.main.feels_like)+"&#8451",T.textContent="Humidity: "+e.main.humidity+"%",q.textContent="Wind: "+e.wind.speed+" km/h"}function z(e){let t=e.name;t=t[0].toUpperCase()+t.substring(1),d.textContent=t,h.textContent="Timezone: "+e.timezone}function w(e){switch(e){case 0:e="Jan.";break;case 1:e="Feb.";break;case 2:e="Mar.";break;case 3:e="Apr.";break;case 4:e="May";break;case 5:e="June";break;case 6:e="July";break;case 7:e="Aug.";break;case 8:e="Sept.";break;case 9:e="Oct.";break;case 10:e="Nov.";break;case 11:e="Dec.";break}return e}function s(e){return e<10&&(e="0"+e),e}function P(e){let t=e.getFullYear(),c=w(e.getMonth()),r=e.getDate(),n=s(e.getHours()),o=s(e.getMinutes());return`${r} ${c} ${t} ${n}:${o}`}function F(e){let t=e.getUTCFullYear(),c=w(e.getUTCMonth()),r=e.getUTCDate(),n=s(e.getUTCHours()),o=s(e.getUTCMinutes());return`${r} ${c} ${t} ${n}:${o}`}function k(){let e=new Date;U.innerHTML="Today is "+P(e),setInterval(console.log("inc 1 sec"),1e3)}function N(e){console.log("====  localTimeMainCard ===");let t=new Date;console.log(e.timezone," ",e.dt);let c=t.getTime()/1e3+e.timezone;C.textContent="Local Time: "+F(new Date(c*1e3))}let a=[];function E(e){const t=[];return e&&t.push("Error in the getting request: not full data --> switch to wi-fi network"),t.length?t.join(`. 
`):""}function _(e){a=[];let t=document.querySelector(".card-main-error");t.textContent="",a.push(E(e)),a.length>0&&(t.classList.remove("errorsInfo-content"),t.classList.add("errorsInfo"),t.innerHTML=a.join(".  <br>"))}k();u.style.display="none";x.addEventListener("click",async function(){event.preventDefault(),k(),O();const e=document.querySelector(".loading-spinner");e.style.display="block";try{const t=await j();console.log("Data City Info:",t),z(t);const c=await v(t.country);console.log("Data Country:",c),H(c);const r=await A();console.log("Data Weather:",r),W(r),N(r),document.querySelector("#input").value=""}catch(t){u.style.display="flex",console.error("Error:",t),_(t)}finally{e.style.display="none",document.querySelector("#input").value=""}});
